{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 88, "column": 0}, "map": {"version":3,"sources":["file:///home/ifeanyi/Desktop/projects/tasktimer/frontend/src/lib/axios.js"],"sourcesContent":["\"use client\";\n\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\nconst api = axios.create({\n  baseURL: process.env.NEXT_PUBLIC_API_BASE_URL,\n  headers: {\n    \"Content-Type\": \"application/json\",\n  },\n  // withCredentials: true,\n});\n\n// Add Authorization header automatically if token exists\napi.interceptors.request.use(\n  (config) => {\n    const accessToken = Cookies.get(\"accessToken\");\n\n    if (accessToken && config.headers) {\n      config.headers.Authorization = `Bearer ${accessToken}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Handle expired token responses globally\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config;\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true;\n      try {\n        const token = Cookies.get(\"refreshToken\");\n        // Make request to auth server to refresh token\n        const { data } = await api.post(\"/refresh-token\", {\n          refreshToken: token,\n        });\n\n        const { accessToken, refreshToken } = data;\n        // Set the new tokens on browser cookie\n        Cookies.set(\"accessToken\", accessToken, { expires: 7 });\n        Cookies.set(\"refreshToken\", refreshToken, { expires: 7 });\n        // Update the authorization header with the new access token\n        api.defaults.headers.common[\"Authorization\"] = `Bearer ${accessToken}`;\n        if (originalRequest.url.includes(\"/logout\")) {\n          originalRequest.data = JSON.stringify({ refreshToken });\n        }\n\n        return api(originalRequest); // Retry the request with th new access token\n      } catch (refreshError) {\n        console.error(\"Token refresh failed:\", refreshError);\n        Cookies.remove(\"accessToken\");\n        Cookies.remove(\"refreshToken\");\n        localStorage.removeItem(\"user\");\n        window.location.href = \"/login\";\n        return Promise.reject(refreshError);\n      }\n    }\n    return Promise.reject(error); // For all other errors, return as is\n  }\n);\n\nexport default api;\n"],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;AAKA,MAAM,MAAM,gJAAK,CAAC,MAAM,CAAC;IACvB,OAAO;IACP,SAAS;QACP,gBAAgB;IAClB;AAEF;AAEA,yDAAyD;AACzD,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,MAAM,cAAc,gKAAO,CAAC,GAAG,CAAC;IAEhC,IAAI,eAAe,OAAO,OAAO,EAAE;QACjC,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,aAAa;IACxD;IACA,OAAO;AACT,GACA,CAAC;IACC,OAAO,QAAQ,MAAM,CAAC;AACxB;AAGF,0CAA0C;AAC1C,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QACzB,IAAI;YACF,MAAM,QAAQ,gKAAO,CAAC,GAAG,CAAC;YAC1B,+CAA+C;YAC/C,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,IAAI,IAAI,CAAC,kBAAkB;gBAChD,cAAc;YAChB;YAEA,MAAM,EAAE,WAAW,EAAE,YAAY,EAAE,GAAG;YACtC,uCAAuC;YACvC,gKAAO,CAAC,GAAG,CAAC,eAAe,aAAa;gBAAE,SAAS;YAAE;YACrD,gKAAO,CAAC,GAAG,CAAC,gBAAgB,cAAc;gBAAE,SAAS;YAAE;YACvD,4DAA4D;YAC5D,IAAI,QAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,gBAAgB,GAAG,CAAC,OAAO,EAAE,aAAa;YACtE,IAAI,gBAAgB,GAAG,CAAC,QAAQ,CAAC,YAAY;gBAC3C,gBAAgB,IAAI,GAAG,KAAK,SAAS,CAAC;oBAAE;gBAAa;YACvD;YAEA,OAAO,IAAI,kBAAkB,6CAA6C;QAC5E,EAAE,OAAO,cAAc;YACrB,QAAQ,KAAK,CAAC,yBAAyB;YACvC,gKAAO,CAAC,MAAM,CAAC;YACf,gKAAO,CAAC,MAAM,CAAC;YACf,aAAa,UAAU,CAAC;YACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YACvB,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IACA,OAAO,QAAQ,MAAM,CAAC,QAAQ,qCAAqC;AACrE;uCAGa","debugId":null}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///home/ifeanyi/Desktop/projects/tasktimer/frontend/src/app/authProvider.jsx"],"sourcesContent":["// context/UserContext.js\n\"use client\"\nimport api from \"@/lib/axios\"\nimport Cookies from \"js-cookie\"\nimport { createContext, useContext, useEffect, useState } from \"react\"\n\nconst UserContext = createContext()\n\nexport function UserProvider({ children }) {\n    const [user, setUser] = useState(null)\n\n    // Load user from local storage\n    useEffect(() => {\n        const storedUser = localStorage.getItem(\"user\")\n        if (storedUser) {\n            setUser(JSON.parse(storedUser))\n        }\n    }, [])\n\n    // keep localStorage in sync whenever user changes\n    useEffect(() => {\n        if (user) {\n            localStorage.setItem(\"user\", JSON.stringify(user))\n        } else {\n            localStorage.removeItem(\"user\")\n        }\n    }, [user])\n\n    // Logout user function\n    const logout = async () => {\n        const refreshToken = Cookies.get(\"refreshToken\")\n        try {\n            const { data } = await api.put(\"/logout\", { refreshToken })\n            if (data.code === 1) {\n                Cookies.remove(\"refreshToken\")\n                Cookies.remove(\"accessToken\")\n                localStorage.removeItem(\"user\")\n                window.location.href = \"/\"\n            }\n        } catch (error) {\n            console.error(error)\n        }\n    }\n\n    return (\n        <UserContext.Provider value={{ user, setUser, logout }}>\n            {children}\n        </UserContext.Provider>\n    )\n}\n\nexport function useUser() {\n    return useContext(UserContext)\n}\n"],"names":[],"mappings":"AAAA,yBAAyB;;;;;;;;AAEzB;AACA;AACA;AAHA;;;;;AAKA,MAAM,4BAAc,IAAA,sNAAa;AAE1B,SAAS,aAAa,EAAE,QAAQ,EAAE;IACrC,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,+BAA+B;IAC/B,IAAA,kNAAS,EAAC;QACN,MAAM,aAAa,aAAa,OAAO,CAAC;QACxC,IAAI,YAAY;YACZ,QAAQ,KAAK,KAAK,CAAC;QACvB;IACJ,GAAG,EAAE;IAEL,kDAAkD;IAClD,IAAA,kNAAS,EAAC;QACN,IAAI,MAAM;YACN,aAAa,OAAO,CAAC,QAAQ,KAAK,SAAS,CAAC;QAChD,OAAO;YACH,aAAa,UAAU,CAAC;QAC5B;IACJ,GAAG;QAAC;KAAK;IAET,uBAAuB;IACvB,MAAM,SAAS;QACX,MAAM,eAAe,gKAAO,CAAC,GAAG,CAAC;QACjC,IAAI;YACA,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,8HAAG,CAAC,GAAG,CAAC,WAAW;gBAAE;YAAa;YACzD,IAAI,KAAK,IAAI,KAAK,GAAG;gBACjB,gKAAO,CAAC,MAAM,CAAC;gBACf,gKAAO,CAAC,MAAM,CAAC;gBACf,aAAa,UAAU,CAAC;gBACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YAC3B;QACJ,EAAE,OAAO,OAAO;YACZ,QAAQ,KAAK,CAAC;QAClB;IACJ;IAEA,qBACI,8OAAC,YAAY,QAAQ;QAAC,OAAO;YAAE;YAAM;YAAS;QAAO;kBAChD;;;;;;AAGb;AAEO,SAAS;IACZ,OAAO,IAAA,mNAAU,EAAC;AACtB","debugId":null}}]
}